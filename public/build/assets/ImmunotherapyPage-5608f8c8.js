import{Q as A,T as O,d as y,l as T,m as V,o as d,c as b,w as p,a as s,b as a,g as x,u as l,q as R,v as w,A as N,e as g,h as P,t as k,F as h,f as C,k as q}from"./app-d29a1c54.js";import{_ as i}from"./InputError-c4a7bcc1.js";import{_ as n}from"./InputLabel-4a24d642.js";import{_}from"./TextInput-1febd58e.js";import{_ as D}from"./PrimaryButton-f8b31512.js";import j from"./Layout-b7f944c2.js";import{d as U}from"./index-ee108f99.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                               */import"./DropdownLink-7a8a95ab.js";const H={class:"mt-1 flex flex-col gap-2"},Q={class:"inline-flex items-center"},z={class:"inline-flex items-center"},G=["value"],J=["disabled"],K={value:"",disabled:"",selected:""},W=["value"],X={key:0,class:"mt-2 text-sm text-red-600"},Z={class:"flex items-center justify-center mt-4"},ee={__name:"ImmunotherapyPage",setup(te){const{url:I}=A(),c=I.split("/");let u=c[c.length-1];u=parseInt(u,10),console.log("Patient ID:",u);let r;c.length===5&&(r=parseInt(c[3],10),u=parseInt(c[4],10));const o=O({lastname:"",email:"",immunoRx_drug:"",immunoRx_initialDate:"",immunoRx_endDate:"",immunoRx_status:"",immunoRx_notes:"",immunoRx_isCompleted:Boolean,immunoRx_facility:"",immunoRx_doctor:""}),v=y(0),S=y([]),$=y([]),L=y(0);if(I){const m=new URL(I,window.location.origin);v.value=m.searchParams.get("currentStep")}else console.error("URL is undefined");const B=()=>{U.Inertia.visit(document.referrer)},F=async()=>{try{const t=(await V.get("/api/all-patients")).data.find(f=>f.patient_id===u);if(console.log("Found patient:",t),t){const f=t.user;o.lastname=f.lastname,o.email=f.email}}catch(m){console.error("Failed to fetch patient info:",m)}},M=async m=>{try{const t=(await V.get(`/api/patient/${m}/treatments`)).data;console.log(t),o.immunoRx_drug=t.immunotherapies[r].immunoRx_drugs,o.immunoRx_initialDate=t.immunotherapies[r].immunoRx_initial_date,o.immunoRx_endDate=t.immunotherapies[r].immunoRx_end_date,o.immunoRx_status=t.immunotherapies[r].immunoRx_status,o.immunoRx_notes=t.immunotherapies[r].immunoRx_notes,o.immunoRx_isCompleted=t.immunotherapies[r].immunoRx_isCompleted===1,o.immunoRx_facility=t.immunotherapies[r].immunoRx_facility,o.immunoRx_doctor=t.immunotherapies[r].immunoRx_doctor}catch(e){console.error("Failed to fetch patient:",e)}};T(async()=>{await F(),await M(u);try{const[m,e]=await Promise.all([V.get("/api/all-doctors"),V.get("/api/hospitals")]);S.value=m.data,$.value=e.data}catch(m){console.error("Error loading initial data:",m)}});const E=()=>{console.log(o),o.post("/api/create-immunotherapy-record",{onSuccess:()=>{L.value===1?U.Inertia.visit(`/treatment-history/immunotherapy/${u}`):v.value?U.Inertia.visit(`/consult/${u}`):window.location.href=`/treatment-history/hormonal/${u}`},onError:m=>{m.patient_id?error.value=m.patient_id[0]:console.log(m)}})};return(m,e)=>(d(),b(j,null,{default:p(()=>[e[25]||(e[25]=s("div",{class:"page-heading"},[s("h1",{class:"main-heading"},"IMMUNOTHERAPY")],-1)),s("form",{onSubmit:q(E,["prevent"]),class:"form-container"},[s("div",null,[a(n,{for:"lastname"},{default:p(()=>e[12]||(e[12]=[x(" Last Name "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),a(_,{id:"lastname",modelValue:l(o).lastname,"onUpdate:modelValue":e[0]||(e[0]=t=>l(o).lastname=t),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname"},null,8,["modelValue"]),a(i,{class:"mt-2",message:l(o).errors.lastname},null,8,["message"])]),s("div",null,[a(n,{for:"email"},{default:p(()=>e[13]||(e[13]=[x(" Email Address "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),a(_,{id:"email",modelValue:l(o).email,"onUpdate:modelValue":e[1]||(e[1]=t=>l(o).email=t),type:"email",class:"mt-1 block w-full",autocomplete:"username"},null,8,["modelValue"]),a(i,{class:"mt-2",message:l(o).errors.email},null,8,["message"])]),s("div",null,[a(n,{for:"immunoRx_drug",value:"Immunotherapy Drug"}),a(_,{id:"immunoRx_drug",modelValue:l(o).immunoRx_drug,"onUpdate:modelValue":e[2]||(e[2]=t=>l(o).immunoRx_drug=t),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),a(i,{message:l(o).errors.immunoRx_drug},null,8,["message"])]),s("div",null,[a(n,{for:"immunoRx_initialDate",value:"Initial Immunotherapy Date"}),a(_,{id:"immunoRx_initialDate",modelValue:l(o).immunoRx_initialDate,"onUpdate:modelValue":e[3]||(e[3]=t=>l(o).immunoRx_initialDate=t),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),a(i,{class:"mt-2",message:l(o).errors.immunoRx_initialDate},null,8,["message"])]),s("div",null,[a(n,{for:"immunoRx_endDate",value:"Last Immunotherapy Date"}),a(_,{id:"immunoRx_endDate",modelValue:l(o).immunoRx_endDate,"onUpdate:modelValue":e[4]||(e[4]=t=>l(o).immunoRx_endDate=t),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),a(i,{class:"mt-2",message:l(o).errors.immunoRx_endDate},null,8,["message"])]),s("div",null,[a(n,{for:"immunoRx_status",value:"Immunotherapy Status"}),R(s("select",{id:"immunoRx_status","onUpdate:modelValue":e[5]||(e[5]=t=>l(o).immunoRx_status=t),class:"mt-1 block w-full"},e[14]||(e[14]=[s("option",{value:"",disabled:""},"Select Immunotherapy Status",-1),s("option",{value:"Ongoing"},"Ongoing",-1),s("option",{value:"Completed"},"Completed",-1),s("option",{value:"Not Completed"},"Not Completed",-1)]),512),[[w,l(o).immunoRx_status]]),a(i,{class:"mt-2",message:l(o).errors.immunoRx_status},null,8,["message"])]),s("div",null,[a(n,{for:"immunoRx_notes",value:"Immunotherapy Notes"}),a(_,{id:"immunoRx_notes",modelValue:l(o).immunoRx_notes,"onUpdate:modelValue":e[6]||(e[6]=t=>l(o).immunoRx_notes=t),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),a(i,{class:"mt-2",message:l(o).errors.immunoRx_notes},null,8,["message"])]),s("div",null,[a(n,{for:"immunoRx_isCompleted",value:"Immunotheraphy Completed"}),s("div",H,[s("label",Q,[R(s("input",{type:"radio",name:"immunoRx_isCompleted",value:!0,"onUpdate:modelValue":e[7]||(e[7]=t=>l(o).immunoRx_isCompleted=t),class:"form-radio"},null,512),[[N,l(o).immunoRx_isCompleted]]),e[15]||(e[15]=s("span",{class:"custom-radio"},null,-1)),e[16]||(e[16]=s("span",{class:"ml-2"},"Yes",-1))]),s("label",z,[R(s("input",{type:"radio",name:"immunoRx_isCompleted",value:!1,"onUpdate:modelValue":e[8]||(e[8]=t=>l(o).immunoRx_isCompleted=t),class:"form-radio"},null,512),[[N,l(o).immunoRx_isCompleted]]),e[17]||(e[17]=s("span",{class:"custom-radio"},null,-1)),e[18]||(e[18]=s("span",{class:"ml-2"},"No",-1))])]),a(i,{class:"mt-2",message:l(o).errors.immunoRx_isCompleted},null,8,["message"])]),s("div",null,[a(n,{for:"immunoRx_facility"},{default:p(()=>e[19]||(e[19]=[x(" Immunotherapy Facility ")])),_:1}),R(s("select",{id:"immunoRx_facility","onUpdate:modelValue":e[9]||(e[9]=t=>l(o).immunoRx_facility=t),class:"mt-1 block w-full",required:""},[e[20]||(e[20]=s("option",{value:"",disabled:""},"Select facility",-1)),(d(!0),g(h,null,P($.value,t=>(d(),g("option",{key:t.hospital_id,value:t.hospital_id},k(t.hospital_name),9,G))),128))],512),[[w,l(o).immunoRx_facility]]),a(i,{class:"mt-2",message:l(o).errors.immunoRx_facility},null,8,["message"])]),s("div",null,[a(n,{for:"immunoRx_doctor"},{default:p(()=>e[21]||(e[21]=[x(" Immunotherapy Doctor ")])),_:1}),R(s("select",{id:"immunoRx_doctor","onUpdate:modelValue":e[10]||(e[10]=t=>l(o).immunoRx_doctor=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:m.isLoading},[s("option",K,k(m.isLoading?"Loading doctors...":"Select a Doctor"),1),(d(!0),g(h,null,P(S.value,t=>(d(),g("option",{key:t.doctor_id,value:t.doctor_id},k("Dr. "+`${t.user.firstname} ${t.user.middlename} ${t.user.lastname}`.toLowerCase().split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1)).join(" ")),9,W))),128))],8,J),[[w,l(o).immunoRx_doctor]]),a(i,{class:"mt-2",message:l(o).errors.immunoRx_doctor},null,8,["message"]),m.error?(d(),g("p",X,k(m.error),1)):C("",!0)]),s("div",Z,[v.value?(d(),b(D,{key:0,onClick:B,class:"ms-4"},{default:p(()=>e[22]||(e[22]=[x(" Back ")])),_:1})):C("",!0),v.value?C("",!0):(d(),b(D,{key:1,onClick:e[11]||(e[11]=t=>L.value=1),class:"ms-4"},{default:p(()=>e[23]||(e[23]=[x(" Submit ")])),_:1})),a(D,{onClick:m.nextStep,class:"ms-4"},{default:p(()=>e[24]||(e[24]=[x(" Submit and Proceed ")])),_:1},8,["onClick"])])],32)]),_:1}))}},pe=Y(ee,[["__scopeId","data-v-300e7811"]]);export{pe as default};
