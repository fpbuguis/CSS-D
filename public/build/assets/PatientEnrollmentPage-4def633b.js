import{d as v,Q as W,l as q,T as X,m as g,p as N,o as p,e as f,b as t,u as a,w as d,F as V,Z as Y,a as o,g as i,f as T,q as b,v as y,h as x,t as U,n as j,k as h}from"./app-d29a1c54.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as n}from"./InputError-c4a7bcc1.js";import{_ as u}from"./InputLabel-4a24d642.js";import{_ as G}from"./PrimaryButton-f8b31512.js";import{_ as m}from"./TextInput-1febd58e.js";import se from"./Layout-b7f944c2.js";/* empty css                                                              */import"./index-ee108f99.js";/* empty css                                                               */import"./DropdownLink-7a8a95ab.js";const le={key:0},re={key:1},ae=["value"],te=["value"],oe=["value"],de=["value"],ie={class:"flex items-center justify-center mt-4"},ne={__name:"PatientEnrollmentPage",setup(ue){const _=v(0),C=v(0),k=v({show:!1,message:"",type:""}),{url:E,props:Z}=W();if(E){const r=new URL(E,window.location.origin);_.value=r.searchParams.get("userId")}else console.error("URL is undefined");const H=async r=>{try{let e=await g.get(`/api/get-user/${r}`);C.value=e.data}catch(e){console.error("Failed to fetch user:",e)}};q(async()=>{await H(_.value)});const s=X({firstname:"",middlename:"",lastname:"",email:"",contact_number:"",password:"",password_confirmation:"",birthday:"",birthplace:"",gender:"",marital_status:"",address_brgy:"",address_street:"",address_number:"",address_zipcode:"",region_id:null,province_id:null,city_id:null,municipality_id:null}),M=v([]),z=v([]),$=v([]),I=v([]);q(async()=>{const r=await g.get("/api/regions");M.value=r.data}),N(C,r=>{var e,l,F,L,A,R,D,O;r&&(s.firstname=r.firstname||"",s.middlename=r.middlename||"",s.lastname=r.lastname||"",s.email=r.email||"",s.contact_number=r.contact_number||"",s.birthday=r.birthday||"",s.birthplace=r.birthplace||"",s.gender=r.gender||"",s.marital_status=r.marital_status||"",s.address_brgy=((e=r.address)==null?void 0:e.address_brgy)||"",s.address_street=((l=r.address)==null?void 0:l.address_street)||"",s.address_number=((F=r.address)==null?void 0:F.address_number)||"",s.address_zipcode=((L=r.address)==null?void 0:L.address_zipcode)||"",s.region_id=((A=r.address)==null?void 0:A.region_id)||null,s.province_id=((R=r.address)==null?void 0:R.province_id)||null,s.city_id=((D=r.address)==null?void 0:D.city_id)||null,s.municipality_id=((O=r.address)==null?void 0:O.municipality_id)||null)},{immediate:!0}),N(()=>s.region_id,async r=>{if(r){const e=await g.get(`/api/provinces/${r}`);z.value=e.data,$.value=[],I.value=[]}}),N(()=>s.province_id,async r=>{if(r){const e=await g.get(`/api/cities/${r}`);$.value=e.data;const l=await g.get(`/api/municipalities/${r}`);I.value=l.data}});function S(){return/^09\d{9}$/.test(s.contact_number)?(s.errors.contact_number=null,!0):(s.errors.contact_number="Format must be in 09xxxxxxxxx.",!1)}let Q=Z.auth.user.user_id;const B=v(null);let w=v(0);const J=async r=>{try{let e=await g.get(`/api/doctor-profile/${r}`);B.value=e.data,w.value=B.value.doctor_id,console.log(w.value)}catch(e){console.error(`Failed to fetch doctor with userId ${r}:`,e)}};q(async()=>{await J(Q)});const K=async()=>{if(k.value.show=!1,!!S())try{const r=await g.post(route("enrollPatient"),s);if(r.status===200){const e=r.data.patient_id;console.log(e),console.log(w.value),await g.post("/api/onboard",{patientId:e,doctorId:w.value}),k.value={show:!0,message:"Success! Patient enrolled.",type:"success"},s.reset()}}catch(r){r.response&&r.response.data.errors?(r.response.data.errors.duplicate&&(s.errors.firstname=r.response.data.errors.duplicate[0]),Object.keys(r.response.data.errors).forEach(e=>{s.errors[e]=r.response.data.errors[e][0]})):console.error("An error occurred:",r)}},P=async()=>{if(k.value.show=!1,!!S())try{const r=await g.post(route("enrollPatient"),s);if(r.status===200){const e=r.data.patient_id;console.log(e),await g.post("/api/onboard",{patientId:e,doctorId:w.value}),s.reset("password","password_confirmation"),k.value={show:!0,message:"Success! Patient enrolled.",type:"success"},window.location.href=`/disease-profile/${e}`}}catch(r){r.response&&r.response.data.errors?(r.response.data.errors.duplicate&&(s.errors.firstname=r.response.data.errors.duplicate[0]),Object.keys(r.response.data.errors).forEach(e=>{s.errors[e]=r.response.data.errors[e][0]})):console.error("An error occurred:",r)}};function c(r){s.errors[r]=null}return(r,e)=>(p(),f(V,null,[t(a(Y),{title:"Patient Enrollment"}),t(se,null,{default:d(()=>[e[55]||(e[55]=o("div",{class:"page-heading"},[o("h1",{class:"main-heading"},"PATIENT ENROLLMENT")],-1)),o("form",{onSubmit:e[28]||(e[28]=h((...l)=>r.submit&&r.submit(...l),["prevent"])),class:"form-container"},[o("div",null,[t(u,{for:"lastname"},{default:d(()=>e[29]||(e[29]=[i(" Last Name "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"lastname",modelValue:a(s).lastname,"onUpdate:modelValue":e[0]||(e[0]=l=>a(s).lastname=l),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"lastname",onInput:e[1]||(e[1]=l=>c("lastname"))},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.lastname},null,8,["message"])]),o("div",null,[t(u,{for:"firstname"},{default:d(()=>e[30]||(e[30]=[i(" First Name "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"firstname",modelValue:a(s).firstname,"onUpdate:modelValue":e[2]||(e[2]=l=>a(s).firstname=l),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"firstname",onInput:e[3]||(e[3]=l=>c("firstname"))},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.firstname},null,8,["message"])]),o("div",null,[t(u,{for:"middlename"},{default:d(()=>e[31]||(e[31]=[i(" Middle Name ")])),_:1}),t(m,{id:"middlename",modelValue:a(s).middlename,"onUpdate:modelValue":e[4]||(e[4]=l=>a(s).middlename=l),type:"text",class:"mt-1 block w-full",autocomplete:"middlename",onInput:e[5]||(e[5]=l=>c("middlename"))},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.middlename},null,8,["message"])]),o("div",null,[t(u,{for:"email"},{default:d(()=>e[32]||(e[32]=[i(" Email Address "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"email",modelValue:a(s).email,"onUpdate:modelValue":e[6]||(e[6]=l=>a(s).email=l),type:"email",class:"mt-1 block w-full",required:"",autocomplete:"username",onInput:e[7]||(e[7]=l=>c("email"))},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.email},null,8,["message"])]),o("div",null,[t(u,{for:"contact_number"},{default:d(()=>e[33]||(e[33]=[i(" Contact Number "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"contact_number",modelValue:a(s).contact_number,"onUpdate:modelValue":e[8]||(e[8]=l=>a(s).contact_number=l),type:"tel",class:"mt-1 block w-full",required:"",onInput:S,placeholder:"ex. 09xxxxxxxxx"},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.contact_number},null,8,["message"])]),_.value?T("",!0):(p(),f("div",le,[t(u,{for:"password"},{default:d(()=>e[34]||(e[34]=[i(" Password "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"password",modelValue:a(s).password,"onUpdate:modelValue":e[9]||(e[9]=l=>a(s).password=l),type:"password",class:"mt-1 block w-full",required:"",autocomplete:"new-password",onInput:e[10]||(e[10]=l=>c("password"))},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.password},null,8,["message"])])),_.value?T("",!0):(p(),f("div",re,[t(u,{for:"password_confirmation"},{default:d(()=>e[35]||(e[35]=[i(" Confirm Password "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"password_confirmation",modelValue:a(s).password_confirmation,"onUpdate:modelValue":e[11]||(e[11]=l=>a(s).password_confirmation=l),type:"password",class:"mt-1 block w-full",disabled:_.value,required:"",autocomplete:"new-password",onInput:e[12]||(e[12]=l=>c("password"))},null,8,["modelValue","disabled"]),t(n,{class:"mt-2",message:a(s).errors.password_confirmation},null,8,["message"])])),o("div",null,[t(u,{for:"birthday"},{default:d(()=>e[36]||(e[36]=[i(" Birthday "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"birthday",modelValue:a(s).birthday,"onUpdate:modelValue":e[13]||(e[13]=l=>a(s).birthday=l),type:"date",class:"mt-1 block w-full",required:"",onInput:e[14]||(e[14]=l=>c("birthday"))},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.birthday},null,8,["message"])]),o("div",null,[t(u,{for:"birthplace",value:"Birthplace"}),t(m,{id:"birthplace",modelValue:a(s).birthplace,"onUpdate:modelValue":e[15]||(e[15]=l=>a(s).birthplace=l),type:"text",class:"mt-1 block w-full",onInput:e[16]||(e[16]=l=>c("birthplace"))},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.birthplace},null,8,["message"])]),o("div",null,[t(u,{for:"gender"},{default:d(()=>e[37]||(e[37]=[i(" Gender "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),b(o("select",{id:"gender","onUpdate:modelValue":e[17]||(e[17]=l=>a(s).gender=l),class:"mt-1 block w-full",onInput:e[18]||(e[18]=l=>c("gender"))},e[38]||(e[38]=[o("option",{value:"",disabled:""},"Select Gender",-1),o("option",{value:"male"},"Male",-1),o("option",{value:"female"},"Female",-1),o("option",{value:"other"},"Other",-1)]),544),[[y,a(s).gender]]),t(n,{class:"mt-2",message:a(s).errors.gender},null,8,["message"])]),o("div",null,[t(u,{for:"marital_status"},{default:d(()=>e[39]||(e[39]=[i(" Marital Status "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),b(o("select",{id:"marital_status","onUpdate:modelValue":e[19]||(e[19]=l=>a(s).marital_status=l),class:"mt-1 block w-full"},e[40]||(e[40]=[o("option",{value:"",disabled:""},"Select Marital Status",-1),o("option",{value:"single"},"Single",-1),o("option",{value:"married"},"Married",-1)]),512),[[y,a(s).marital_status]]),t(n,{class:"mt-2",message:a(s).errors.marital_status},null,8,["message"])]),o("div",null,[t(u,{for:"region_id"},{default:d(()=>e[41]||(e[41]=[i(" Region "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),b(o("select",{id:"region_id","onUpdate:modelValue":e[20]||(e[20]=l=>a(s).region_id=l),class:"mt-1 block w-full",required:""},[e[42]||(e[42]=o("option",{value:"",disabled:""},"Select Region",-1)),(p(!0),f(V,null,x(M.value,l=>(p(),f("option",{key:l.region_id,value:l.region_id},U(l.region_name),9,ae))),128))],512),[[y,a(s).region_id]]),t(n,{class:"mt-2",message:a(s).errors.region_id},null,8,["message"])]),o("div",null,[t(u,{for:"province_id"},{default:d(()=>e[43]||(e[43]=[i(" Province "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),b(o("select",{id:"province_id","onUpdate:modelValue":e[21]||(e[21]=l=>a(s).province_id=l),class:"mt-1 block w-full",required:""},[e[44]||(e[44]=o("option",{value:"",disabled:""},"Select Province",-1)),(p(!0),f(V,null,x(z.value,l=>(p(),f("option",{key:l.province_id,value:l.province_id},U(l.province_name),9,te))),128))],512),[[y,a(s).province_id]]),t(n,{class:"mt-2",message:a(s).errors.province_id},null,8,["message"])]),o("div",null,[t(u,{for:"city_id"},{default:d(()=>e[45]||(e[45]=[i(" City ")])),_:1}),b(o("select",{id:"city_id","onUpdate:modelValue":e[22]||(e[22]=l=>a(s).city_id=l),class:"mt-1 block w-full"},[e[46]||(e[46]=o("option",{value:"",disabled:""},"Select City",-1)),(p(!0),f(V,null,x($.value,l=>(p(),f("option",{key:l.city_id,value:l.city_id},U(l.city_name),9,oe))),128))],512),[[y,a(s).city_id]]),t(n,{class:"mt-2",message:a(s).errors.city_id},null,8,["message"])]),o("div",null,[t(u,{for:"municipality_id"},{default:d(()=>e[47]||(e[47]=[i(" Municipality ")])),_:1}),b(o("select",{id:"municipality_id","onUpdate:modelValue":e[23]||(e[23]=l=>a(s).municipality_id=l),class:"mt-1 block w-full"},[e[48]||(e[48]=o("option",{value:"",disabled:""},"Select Municipality",-1)),(p(!0),f(V,null,x(I.value,l=>(p(),f("option",{key:l.municipality_id,value:l.municipality_id},U(l.municipality_name),9,de))),128))],512),[[y,a(s).municipality_id]]),t(n,{class:"mt-2",message:a(s).errors.municipality_id},null,8,["message"])]),o("div",null,[t(u,{for:"address_brgy"},{default:d(()=>e[49]||(e[49]=[i(" Barangay "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"address_brgy",modelValue:a(s).address_brgy,"onUpdate:modelValue":e[24]||(e[24]=l=>a(s).address_brgy=l),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.address_brgy},null,8,["message"])]),o("div",null,[t(u,{for:"address_number"},{default:d(()=>e[50]||(e[50]=[i(" Block/House Number "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"address_number",modelValue:a(s).address_number,"onUpdate:modelValue":e[25]||(e[25]=l=>a(s).address_number=l),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.address_number},null,8,["message"])]),o("div",null,[t(u,{for:"address_street"},{default:d(()=>e[51]||(e[51]=[i(" Street "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"address_street",modelValue:a(s).address_street,"onUpdate:modelValue":e[26]||(e[26]=l=>a(s).address_street=l),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.address_street},null,8,["message"])]),o("div",null,[t(u,{for:"address_zipcode"},{default:d(()=>e[52]||(e[52]=[i(" Zipcode "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"address_zipcode",modelValue:a(s).address_zipcode,"onUpdate:modelValue":e[27]||(e[27]=l=>a(s).address_zipcode=l),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(n,{class:"mt-2",message:a(s).errors.address_zipcode},null,8,["message"])]),o("div",ie,[t(G,{class:j(["ms-4",{"opacity-25":a(s).processing}]),disabled:a(s).processing,onClick:K},{default:d(()=>e[53]||(e[53]=[i(" Submit ")])),_:1},8,["class","disabled"]),t(G,{class:j(["ms-4",{"opacity-25":a(s).processing}]),disabled:a(s).processing,onClick:P},{default:d(()=>e[54]||(e[54]=[i(" Submit & Add Disease Profile ")])),_:1},8,["class","disabled"])])],32)]),_:1})],64))}},ke=ee(ne,[["__scopeId","data-v-a89111b2"]]);export{ke as default};
