import{Q as B,d as R,T as O,l as j,m as p,o as _,c as h,w as f,a as s,b as l,g as y,u as a,q as v,v as V,A as S,e as I,h as D,t as w,F as N,f as $,k as q}from"./app-d29a1c54.js";import{_ as i}from"./InputError-c4a7bcc1.js";import{_ as n}from"./InputLabel-4a24d642.js";import{_ as c}from"./TextInput-1febd58e.js";import{_ as Y}from"./PrimaryButton-f8b31512.js";import H from"./Layout-b7f944c2.js";import{A as Q}from"./Alert-c8b905ec.js";import{d as z}from"./index-ee108f99.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                               */import"./DropdownLink-7a8a95ab.js";/* empty css                                                              */const J={class:"mt-1 flex flex-col gap-2"},K={class:"inline-flex items-center"},W={class:"inline-flex items-center"},X=["value"],Z=["disabled"],ee={value:"",disabled:"",selected:""},te=["value"],oe={key:0,class:"mt-2 text-sm text-red-600"},se={class:"flex items-center justify-center mt-4"},ae={__name:"ImmunotherapyUpdatePage",setup(le){const{url:b,props:U}=B(),x=b.split("/");let r=x[x.length-1];r=parseInt(r,10),console.log("Patient ID:",r);let u;x.length===4&&(u=parseInt(x[2],10),r=parseInt(x[3],10));const L=U.auth.user.user_id,P=U.auth.user.email,g=R({show:!1,message:"",type:""}),o=O({lastname:"",email:"",immunoRx_drugs:"",immunoRx_initial_date:"",immunoRx_end_date:"",immunoRx_status:"",immunoRx_notes:"",immunoRx_isCompleted:Boolean,immunoRx_facility:"",immunoRx_doctor:""}),E=R(0),C=R([]),k=R([]),M=R(0);if(b){const m=new URL(b,window.location.origin);E.value=m.searchParams.get("currentStep")}else console.error("URL is undefined");const T=async()=>{try{const t=(await p.get("/api/all-patients")).data.find(d=>d.patient_id===r);if(console.log("Found patient:",t),t){const d=t.user;o.lastname=d.lastname,o.email=d.email}}catch(m){console.error("Failed to fetch patient info:",m)}},A=async m=>{try{const t=(await p.get(`/api/patient/${m}/treatments`)).data;console.log(t),o.immunoRx_drugs=t.immunotherapies[u].immunoRx_drugs,o.immunoRx_initial_date=t.immunotherapies[u].immunoRx_initial_date,o.immunoRx_end_date=t.immunotherapies[u].immunoRx_end_date,o.immunoRx_status=t.immunotherapies[u].immunoRx_status,o.immunoRx_notes=t.immunotherapies[u].immunoRx_notes,o.immunoRx_isCompleted=t.immunotherapies[u].immunoRx_isCompleted===1,o.immunoRx_facility=t.immunotherapies[u].immunoRx_facility,o.immunoRx_doctor=t.immunotherapies[u].immunoRx_doctor}catch(e){console.error("Failed to fetch patient:",e)}};j(async()=>{await T(),await A(r);try{const[m,e]=await Promise.all([p.get("/api/all-doctors"),p.get("/api/hospitals")]);C.value=m.data,k.value=e.data}catch(m){console.error("Error loading initial data:",m)}});const F=async()=>{try{g.value.show=!1,console.log(o);const m=await p.put(`/api/treatment/update/immunotherapy/${r}`,o),e=await p.get(`/api/get-patient/${r}`);await p.post("/api/create-notification-log",{from:P,to:e.data.user.email,subject:"Treatment Information Updated",message:"The patient's IMMUNOTHERAPY treatment is updated",senderId:L,receiverId:e.data.user.user_id,notificationStatus:1,notificationType:5}),m.status===200?(g.value={show:!0,message:"Success! Immunotherapy details updated.",type:"success"},z.Inertia.get("/search")):console.error("Error updating details:",m.status)}catch(m){console.error("Error updating details:",m)}};return(m,e)=>(_(),h(H,null,{default:f(()=>[e[23]||(e[23]=s("div",{class:"page-heading"},[s("h1",{class:"main-heading"},"IMMUNOTHERAPY")],-1)),s("form",{onSubmit:q(F,["prevent"]),class:"form-container"},[s("div",null,[l(n,{for:"lastname"},{default:f(()=>e[12]||(e[12]=[y(" Last Name "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),l(c,{id:"lastname",modelValue:a(o).lastname,"onUpdate:modelValue":e[0]||(e[0]=t=>a(o).lastname=t),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname",disabled:""},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.lastname},null,8,["message"])]),s("div",null,[l(n,{for:"email"},{default:f(()=>e[13]||(e[13]=[y(" Email Address "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),l(c,{id:"email",modelValue:a(o).email,"onUpdate:modelValue":e[1]||(e[1]=t=>a(o).email=t),type:"email",class:"mt-1 block w-full",autocomplete:"username",disabled:""},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.email},null,8,["message"])]),s("div",null,[l(n,{for:"immunoRx_drugs",value:"Immunotherapy Drug"}),l(c,{id:"immunoRx_drugs",modelValue:a(o).immunoRx_drugs,"onUpdate:modelValue":e[2]||(e[2]=t=>a(o).immunoRx_drugs=t),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{message:a(o).errors.immunoRx_drugs},null,8,["message"])]),s("div",null,[l(n,{for:"immunoRx_initialDate",value:"Initial Immunotherapy Date"}),l(c,{id:"immunoRx_initial_date",modelValue:a(o).immunoRx_initial_date,"onUpdate:modelValue":e[3]||(e[3]=t=>a(o).immunoRx_initial_date=t),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.immunoRx_initial_date},null,8,["message"])]),s("div",null,[l(n,{for:"immunoRx_end_date",value:"Last Immunotherapy Date"}),l(c,{id:"immunoRx_end_date",modelValue:a(o).immunoRx_end_date,"onUpdate:modelValue":e[4]||(e[4]=t=>a(o).immunoRx_end_date=t),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.immunoRx_end_date},null,8,["message"])]),s("div",null,[l(n,{for:"immunoRx_status",value:"Immunotherapy Status"}),v(s("select",{id:"immunoRx_status","onUpdate:modelValue":e[5]||(e[5]=t=>a(o).immunoRx_status=t),class:"mt-1 block w-full"},e[14]||(e[14]=[s("option",{value:"",disabled:""},"Select Immunotherapy Status",-1),s("option",{value:"Ongoing"},"Ongoing",-1),s("option",{value:"Completed"},"Completed",-1),s("option",{value:"Not Completed"},"Not Completed",-1)]),512),[[V,a(o).immunoRx_status]]),l(i,{class:"mt-2",message:a(o).errors.immunoRx_status},null,8,["message"])]),s("div",null,[l(n,{for:"immunoRx_notes",value:"Immunotherapy Notes"}),l(c,{id:"immunoRx_notes",modelValue:a(o).immunoRx_notes,"onUpdate:modelValue":e[6]||(e[6]=t=>a(o).immunoRx_notes=t),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.immunoRx_notes},null,8,["message"])]),s("div",null,[l(n,{for:"immunoRx_isCompleted",value:"Immunotheraphy Completed"}),s("div",J,[s("label",K,[v(s("input",{type:"radio",name:"immunoRx_isCompleted",value:!0,"onUpdate:modelValue":e[7]||(e[7]=t=>a(o).immunoRx_isCompleted=t),class:"form-radio"},null,512),[[S,a(o).immunoRx_isCompleted]]),e[15]||(e[15]=s("span",{class:"custom-radio"},null,-1)),e[16]||(e[16]=s("span",{class:"ml-2"},"Yes",-1))]),s("label",W,[v(s("input",{type:"radio",name:"immunoRx_isCompleted",value:!1,"onUpdate:modelValue":e[8]||(e[8]=t=>a(o).immunoRx_isCompleted=t),class:"form-radio"},null,512),[[S,a(o).immunoRx_isCompleted]]),e[17]||(e[17]=s("span",{class:"custom-radio"},null,-1)),e[18]||(e[18]=s("span",{class:"ml-2"},"No",-1))])]),l(i,{class:"mt-2",message:a(o).errors.immunoRx_isCompleted},null,8,["message"])]),s("div",null,[l(n,{for:"immunoRx_facility"},{default:f(()=>e[19]||(e[19]=[y(" Immunotherapy Facility ")])),_:1}),v(s("select",{id:"immunoRx_facility","onUpdate:modelValue":e[9]||(e[9]=t=>a(o).immunoRx_facility=t),class:"mt-1 block w-full",required:""},[e[20]||(e[20]=s("option",{value:"",disabled:""},"Select facility",-1)),(_(!0),I(N,null,D(k.value,t=>(_(),I("option",{key:t.hospital_id,value:t.hospital_id},w(t.hospital_name),9,X))),128))],512),[[V,a(o).immunoRx_facility]]),l(i,{class:"mt-2",message:a(o).errors.immunoRx_facility},null,8,["message"])]),s("div",null,[l(n,{for:"immunoRx_doctor"},{default:f(()=>e[21]||(e[21]=[y(" Immunotherapy Doctor ")])),_:1}),v(s("select",{id:"immunoRx_doctor","onUpdate:modelValue":e[10]||(e[10]=t=>a(o).immunoRx_doctor=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:m.isLoading},[s("option",ee,w(m.isLoading?"Loading doctors...":"Select a Doctor"),1),(_(!0),I(N,null,D(C.value,t=>(_(),I("option",{key:t.doctor_id,value:t.doctor_id},w("Dr. "+`${t.user.firstname} ${t.user.middlename} ${t.user.lastname}`.toLowerCase().split(" ").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" ")),9,te))),128))],8,Z),[[V,a(o).immunoRx_doctor]]),l(i,{class:"mt-2",message:a(o).errors.immunoRx_doctor},null,8,["message"]),m.error?(_(),I("p",oe,w(m.error),1)):$("",!0)]),s("div",se,[l(Y,{onClick:e[11]||(e[11]=t=>M.value=1),class:"ms-4"},{default:f(()=>e[22]||(e[22]=[y(" Update Details ")])),_:1})])],32),g.value.show?(_(),h(Q,{key:0,message:g.value.message,type:g.value.type},null,8,["message","type"])):$("",!0)]),_:1}))}},Re=G(ae,[["__scopeId","data-v-5ba910c9"]]);export{Re as default};
